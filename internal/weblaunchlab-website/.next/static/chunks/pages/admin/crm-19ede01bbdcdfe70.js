(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[993],{3252:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crm",function(){return a(4144)}])},4178:function(e,t,a){"use strict";var r=a(5893);t.Z=e=>{let{title:t,value:a,icon:n,change:s,changeType:o="neutral",color:l="blue"}=e;return(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:t}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a}),s&&(0,r.jsxs)("div",{className:"flex items-center mt-2",children:[(0,r.jsxs)("span",{className:"text-sm font-medium ".concat({positive:"text-green-600",negative:"text-red-600",neutral:"text-gray-500"}[o]),children:["positive"===o&&"+",s]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"vs last month"})]})]}),(0,r.jsx)("div",{className:"p-3 rounded-lg ".concat({blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",orange:"bg-orange-50 text-orange-600",purple:"bg-purple-50 text-purple-600",gray:"bg-gray-50 text-gray-600"}[l]),children:n})]})})}},4144:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var r=a(5893),n=a(7294),s=a(1639),o=a(4178),l=a(7190);function i(){let[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)({totalDeals:0,totalValue:0,wonDeals:0,conversionRate:0}),[d,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{u()},[]);let u=async()=>{try{let e=await fetch("/api/admin/hubspot-deals");if(e.ok){let a=await e.json();t(a);let r=a.reduce((e,t)=>e+(t.amount||0),0),n=a.filter(e=>"closedwon"===e.stage).length,s=a.length>0?n/a.length*100:0;i({totalDeals:a.length,totalValue:r,wonDeals:n,conversionRate:s})}}catch(e){console.error("Error fetching deals:",e)}finally{c(!1)}},x=async(e,t)=>{try{(await fetch("/api/admin/hubspot-deals",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({dealId:e,stage:t})})).ok&&await u()}catch(e){console.error("Error updating deal:",e)}},g=e=>({appointmentscheduled:"bg-blue-100 text-blue-800",qualifiedtobuy:"bg-yellow-100 text-yellow-800",presentationscheduled:"bg-purple-100 text-purple-800",decisionmakerboughtin:"bg-green-100 text-green-800",contractsent:"bg-orange-100 text-orange-800",closedwon:"bg-green-200 text-green-900",closedlost:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800",h=e=>({appointmentscheduled:"Appointment",qualifiedtobuy:"Qualified",presentationscheduled:"Presentation",decisionmakerboughtin:"Decision Maker",contractsent:"Contract Sent",closedwon:"Won",closedlost:"Lost"})[e]||e,p=[{key:"name",label:"Deal Name",sortable:!0,render:(e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:t.type})]})},{key:"amount",label:"Value",sortable:!0,render:e=>(0,r.jsxs)("span",{className:"font-semibold text-gray-900 dark:text-white",children:["$",(null==e?void 0:e.toLocaleString())||"0"]})},{key:"stage",label:"Stage",render:e=>(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(g(e)),children:h(e)})},{key:"source",label:"Source",render:e=>(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400 capitalize",children:e||"Unknown"})},{key:"createdAt",label:"Created",sortable:!0,render:e=>(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:e?new Date(e).toLocaleDateString():"-"})},{key:"actions",label:"Actions",render:(e,t)=>(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("select",{className:"text-xs border rounded px-2 py-1 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300",defaultValue:t.stage,onChange:e=>x(t.id,e.target.value),children:[(0,r.jsx)("option",{value:"appointmentscheduled",children:"Appointment"}),(0,r.jsx)("option",{value:"qualifiedtobuy",children:"Qualified"}),(0,r.jsx)("option",{value:"presentationscheduled",children:"Presentation"}),(0,r.jsx)("option",{value:"decisionmakerboughtin",children:"Decision Maker"}),(0,r.jsx)("option",{value:"contractsent",children:"Contract Sent"}),(0,r.jsx)("option",{value:"closedwon",children:"Won"}),(0,r.jsx)("option",{value:"closedlost",children:"Lost"})]})})}];return d?(0,r.jsx)(s.Z,{title:"CRM Pipeline",children:(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})}):(0,r.jsx)(s.Z,{title:"CRM Pipeline",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(o.Z,{title:"Total Deals",value:a.totalDeals,color:"blue",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,r.jsx)(o.Z,{title:"Total Value",value:"$".concat(a.totalValue.toLocaleString()),color:"green",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),(0,r.jsx)(o.Z,{title:"Won Deals",value:a.wonDeals,color:"purple",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)(o.Z,{title:"Conversion Rate",value:"".concat(a.conversionRate.toFixed(1),"%"),color:"orange",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]}),(0,r.jsx)(l.Z,{title:"All Deals",data:e,columns:p,actions:[(0,r.jsx)("button",{onClick:u,className:"px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700",children:"Refresh"},"refresh"),(0,r.jsx)("button",{onClick:()=>window.open("https://app.hubspot.com/","_blank"),className:"px-3 py-1.5 text-sm font-medium text-white bg-orange-600 rounded-md hover:bg-orange-700",children:"Open HubSpot"},"hubspot")],emptyState:{title:"No deals found",description:"Start by capturing leads from your website or create deals manually in HubSpot."}})]})})}}},function(e){e.O(0,[664,689,888,774,179],function(){return e(e.s=3252)}),_N_E=e.O()}]);